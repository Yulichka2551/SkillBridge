paths:
  /lessons:
    get:
      security:
        - cookieAuth: []
      tags:
        - Lessons
      summary: Find all lessons.
      description: Finds and returns an array with a list of all lessons.
      produces:
        - application/json
      parameters:
        - in: query
          name: title
          schema:
            type: string
          required: false
        - in: query
          name: sort
          schema:
            type: string
          required: false
        - in: query
          name: limit
          schema:
            type: integer
          required: false
        - in: query
          name: skip
          schema:
            type: integer
          required: false
        - in: query
          name: includeDuplicates
          schema:
            type: boolean
          required: false
          description: If true will include in response lessons that have isDuplicate set to true.
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/definitions/lessons'
              example:
                count: 2
                items:
                  - _id: 677c1271a1d060a32ade5ff3
                    author: 67519181170a70623366d30c
                    title: Lesson 1
                    description: Description for lesson 1.
                    content: '<h2>Heading 2</h2>\n<p style=\"line-height: 1.1;\">Some paragraph text here</p>\n<pre>A preformatted text</pre>\n<table style=\"border-collapse: collapse; width: 99.9979%;\" border=\"1\"><colgroup><col style=\"width: 49.9486%;\"><col style=\"width: 49.9486%;\"></colgroup>\n<tbody>\n<tr>\n<td>Column 1</td>\n<td>Coulmn 2</td>\n</tr>\n<tr>\n<td>Column 1 content</td>\n<td>Column 2 content</td>\n</tr>\n</tbody>\n</table>\n<pre>&nbsp;</pre>'
                    attachments:
                      - 677c11a0a1d060a32ade5fe5
                      - 677c1199a1d060a32ade5fe1
                    category:
                      _id: 677c11c0a1d060a32ade5fed
                      name: math
                    resourceType: lesson
                    createdAt: 2025-01-06T17:27:13.697Z
                    updatedAt: 2025-01-06T17:27:13.697Z
                  - _id: 677c1506a1d060a32ade600e
                    author: 67519181170a70623366d30c
                    title: Lesson 2
                    description: Description for lesson 2.
                    content: <h4>Very very very long lesson text and something else</h4>
                    attachments: []
                    category:
                      _id: 677c11c0a1d060a32ade5fed
                      name: math
                    resourceType: lesson
                    createdAt: 2025-01-06T17:38:14.016Z
                    updatedAt: 2025-01-06T17:38:14.016Z
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 401
                code: UNAUTHORIZED
                message: The requested URL requires user authorization.
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 403
                code: FORBIDDEN
                message: You do not have permission to perform this action.
    post:
      security:
        - cookieAuth: []
      tags:
        - Lessons
      summary: Creates a new lesson.
      description: Creates a new lesson with possibility to attach files and saves it to the database.
      produces:
        - application/json
      requestBody:
        required: true
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/definitions/postLessonBody'
              required:
                - title
                - description
                - content
            example:
              title: Colors in English
              description: With this lesson you will learn all about colors in English.
              content: <h1>Very very very long lesson title and something else</h1>
              attachments:
                - author: 67519181170a70623366d30c
                  category:
                    name: Math
                    _id: 677c11c0a1d060a32ade5fed
                  fileName: image.png
                  link: 1736184224413-image.png
                  resourceType: attachment
                  size: 195123
                  createdAt: 2023-02-14T23:44:21.334Z
                  updatedAt: 2023-02-14T23:44:21.334Z
                  _id: 677c11a0a1d060a32ade5fe5
              category: 677c11c0a1d060a32ade5fed
      responses:
        201:
          description: Created
          content:
            application/json:
              schema:
                $ref: '#/definitions/lesson'
              example:
                title: Colors in English
                description: With this lesson you will learn all about colors in English.
                content: <h1>Title</h1>
                author: 63da8767c9ad4c9a0b0eacd3
                attachments:
                  - 63ed1cd25e9d781cdb6a6b15
                category: 6477007a6fa4d05e1a800ce1
                resourceType: lesson
                _id: 63ec1cd51e9d781cdb6f4b14
                createdAt: 2023-02-14T23:44:21.334Z
                updatedAt: 2023-02-14T23:44:21.334Z
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 401
                code: UNAUTHORIZED
                message: The requested URL requires user authorization.
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 403
                code: FORBIDDEN
                message: You do not have permission to perform this action.
  /lessons/{id}:
    get:
      security:
        - cookieAuth: []
      tags:
        - Lessons
      summary: Find and return lesson by ID
      description: Finds and returns a lesson with the specified ID.
      produces:
        - application/json
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the lesson that needs to be fetched
          type: string
      responses:
        200:
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/definitions/lessonById'
              example:
                _id: 93ec1cd51e9d781cdb6f5b56
                author: 64a33e71eea95284f397a6ee
                title: Title of the lesson
                description: Some information about this lesson
                content: <h1>Lesson title</h1>\n<p>Some long description for the lesson.</p>\n<p>Another paragraph for the lesson.</p>
                attachments:
                  - _id: 63ec1cd51e9d781cdb6f4b14
                    author: 648afee884936e09a37deaaa
                    fileName: EnglishB2Level.pdf
                    link: 3302931_EnglishB2Level.pdf
                    size: 195123
                    category: 677c11c0a1d060a32ade5fed
                    resourceType: attachment
                    createdAt: 2023-02-14T23:44:21.334Z
                    updatedAt: 2023-02-14T23:44:21.334Z
                category: 6477007a6fa4d05e1a800ce1
                resourceType: lesson
                createdAt: 2023-02-14T23:44:21.334Z
                updatedAt: 2023-02-14T23:44:21.334Z
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 400
                code: INVALID_ID
                message: ID is invalid.
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 401
                code: UNAUTHORIZED
                message: The requested URL requires user authorization.
        404:
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 404
                code: DOCUMENT_NOT_FOUND
                message: Lesson with the specified id was not found.
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 403
                code: FORBIDDEN
                message: You do not have permission to perform this action.
    patch:
      security:
        - cookieAuth: []
      tags:
        - Lessons
      summary: Update a lesson.
      description: Update a lesson by ID and restricted only for tutor
      produces:
        - application/json
      parameters:
        - name: id
          in: path
          required: true
          description: ID of category
          type: string
      requestBody:
        required: true
        description: Data for update a lesson.
        content:
          application/json:
            schema:
              $ref: '#/definitions/postLessonBody'
            example:
              title: Colors in English 2
              description: With this lesson you will learn all about colors in English, part 2.
              content: <h1>New very very long lesson title and something else, updated</h1>
              attachments:
                - author: 67519181170a70623366d30c
                  category:
                    name: Math
                    _id: 677c11c0a1d060a32ade5fed
                  fileName: colors.png
                  link: 1736184224413-colors.png
                  resourceType: attachment
                  size: 195123
                  createdAt: 2023-02-14T23:44:21.334Z
                  updatedAt: 2023-02-14T23:44:21.334Z
                  _id: 687c11a0a1d089a32ade5be6
              category: 677c11c0a1d060a32ade5fed
      responses:
        204:
          description: No Content
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 400
                code: INVALID_ID
                message: ID is invalid.
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 401
                code: UNAUTHORIZED
                message: The requested URL requires user authorization.
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 403
                code: FORBIDDEN
                message: You do not have permission to perform this action.
        404:
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 404
                code: DOCUMENT_NOT_FOUND
                message: Lesson with the specified id was not found.
    delete:
      security:
        - cookieAuth: []
      tags:
        - Lessons
      summary: Delete lesson by ID
      description: Finds and deletes a lesson with the specified ID.
      produces:
        - application/json
      parameters:
        - name: id
          in: path
          required: true
          description: ID of the lesson that needs to be deleted
          type: string
      responses:
        204:
          description: No Content
        400:
          description: Bad Request
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 400
                code: INVALID_ID
                message: ID is invalid.
        401:
          description: Unauthorized
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 401
                code: UNAUTHORIZED
                message: The requested URL requires user authorization.
        403:
          description: Forbidden
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 403
                code: FORBIDDEN
                message: You do not have permission to perform this action.
        404:
          description: Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/Error'
              example:
                status: 404
                code: DOCUMENT_NOT_FOUND
                message: Lesson with the specified id was not found.
